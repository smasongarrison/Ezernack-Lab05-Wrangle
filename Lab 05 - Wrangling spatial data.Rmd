---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Charlize Ezernack"
date: "Insert date here"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 

```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")


```

### Exercise 1

```{r filterdennys}
dn_ak <- dennys %>%
  filter(state == "AK")
nrow(dn_ak)

```

There are 3 Dennys locations in Alaska.

### Exercise 2

```{r filterquinta}
lq_ak <- laquinta %>%
  filter(state == "AK")
nrow(lq_ak)

```

There are 2 La Quinta locations in Alaska.

### Exercise 3

We are looking of 6 pairings of Dennys x La Quinta locations so I will need to calculate 6 distances between locations. 


### Exercise 4

```{r joindata}

dn_lq_ak <- full_join(dn_ak, lq_ak,
  by = "state"
)
dn_lq_ak

```

There are 12 observations in the joined data frame. 

### Exercise 5

We will use the mutate() function to add a new variable into the data frame while keeping the existing variables. 


### Exercise 6
```{r calculatedistance}
haversine <- function(longitude.x, latitude.x, longitude.y, latitude.y, round = 3) {
  

  # convert to radians
  long1 <- longitude.x * pi / 180
  lat1 <- latitude.x * pi / 180
  long2 <- longitude.y * pi / 180
  lat2 <- latitude.y * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - long1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
  
} 
dn_lq_ak <- dn_lq_ak %>% mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y))

```

### Exercise 7

```{r mindennys}
dn_lq_ak <- dn_lq_ak %>% group_by(address.x) %>% mutate(mindistance = min(distance, na.rm = FALSE))

```

### Exercise 8
```{r mindennys}
 ##dn_lq_ak %>% ggplot(aes(x=mindistance)) + geom_bar()
```

The distribution of Dennys to the closest La Quinta is over 16,000 miles in alaska.  
